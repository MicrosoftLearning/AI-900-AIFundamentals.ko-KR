---
lab:
  title: Azure ML에서 자동화된 Machine Learning 살펴보기
---

# Azure ML에서 자동화된 Machine Learning 살펴보기

이 연습에서는 Azure Machine Learning의 자동화된 기계 학습 기능을 사용하여 기계 학습 모델을 학습하고 평가합니다. 그런 다음, 학습된 모델을 배포하고 테스트합니다.

이 연습을 완료하는 데 약 **30**분 정도 소요됩니다.

> **참고** 이 랩을 완료하려면 관리 액세스 권한이 있는 [Azure 구독](https://azure.microsoft.com/free)이 필요합니다.

## Azure Machine Learning 작업 영역 만들기

Azure Machine Learning을 사용하려면 Azure 구독에서 Azure Machine Learning 작업 영역을 프로비전해야 합니다. 그런 다음 Azure Machine Learning 스튜디오 사용하여 작업 영역의 리소스로 작업할 수 있습니다.

> **팁**: Azure Machine Learning 작업 영역이 이미 있는 경우 이를 사용하고 다음 작업으로 건너뛸 수 있습니다.

1. Microsoft 자격 증명을 사용하여 [Azure Portal](https://portal.azure.com) `https://portal.azure.com` 로그인합니다.

1. **+ 리소스 만들기를** 선택하고, *Machine Learning*을 검색하고, 다음 설정을 사용하여 새 **Azure Machine Learning** 리소스를 만듭니다.
    - **구독**: *자신의 Azure 구독*.
    - **리소스 그룹**: 리소스 그룹 만들거나 선택하기
    - **이름**: *작업 영역의 고유한 이름을 입력합니다*.
    - **지역**: 지리적으로 가장 가까운 지역 선택
    - **스토리지 계정**: 작업 영역에 대해 만들 새로운 기본 스토리지 계정
    - **키 자격 증명 모음**: 작업 영역에 대해 만들 새로운 기본 키 자격 증명 모음
    - **Application insights**: 작업 영역에 대해 만들 새로운 기본 Application Insights 리소스
    - **컨테이너 레지스트리**: 없음(처음으로 컨테이너에 모델을 배포할 때 자동으로 만들어짐)

1. **검토 + 생성**를 선택한 다음, **생성**를 선택합니다. 작업 영역이 만들어질 때까지 기다린 다음(몇 분 정도 걸릴 수 있음) 배포된 리소스로 이동합니다.

1. **Studio 시작**을 선택하거나 또는 새 브라우저 탭을 열고 [https://ml.azure.com](https://ml.azure.com?azure-portal=true)로 이동한 다음, Microsoft 계정을 사용하여 Azure Machine Learning 스튜디오에 로그인합니다. 표시되는 모든 메시지를 닫습니다.

1. Azure Machine Learning 스튜디오에서 새로 만든 작업 영역이 표시됩니다. 그렇지 않은 경우 왼쪽 메뉴에서 **모든 작업 영역을** 선택한 다음, 방금 만든 작업 영역을 선택합니다.

## 미리 보기 기능 사용

Azure Machine Learning의 일부 기능은 미리 보기 상태이며 작업 영역에서 명시적으로 사용하도록 설정해야 합니다.

1. Azure Machine Learning Studio에서 **미리 보기 기능 관리** (스피커 아이콘 - &#128363;)를 클릭합니다.

    ![메뉴의 미리 보기 기능 관리 단추 스크린샷](../instructions/media/use-automated-machine-learning/severless-compute-1.png)

1. 다음 미리 보기 기능을 사용하도록 설정합니다.

    - *서버리스 컴퓨팅을 사용하여 학습 작업을 제출하기 위한 단계별 환경*

## 자동화된 기계 학습을 사용하여 모델 학습

자동화된 기계 학습을 사용하면 여러 알고리즘과 매개 변수를 사용해 여러 모델을 학습시키고 데이터에 가장 적합한 모델을 식별할 수 있습니다. 이 연습에서는 기록 자전거 대여 세부 정보의 데이터 세트를 사용하여 계절 및 기상 특징에 따라 지정된 날에 예상되는 자전거 대여 수를 예측하는 모델을 학습시킵니다.

> **인용**: *이 연습에 사용된 데이터는 [Capital Bikeshare](https://www.capitalbikeshare.com/system-data)에서 파생되며 게시된 데이터 [사용권 계약에](https://www.capitalbikeshare.com/data-license-agreement) 따라 사용됩니다*.


1. [Azure Machine Learning 스튜디오](https://ml.azure.com?azure-portal=true) **자동화된 ML** 페이지(작성 아래)**를 봅니다**.

1. 사용자 인터페이스를 진행하는 데 필요한 경우 **Next** 를 사용하여 다음 설정을 사용하여 새 자동화된 ML 작업을 만듭니다.

    **기본 설정**:

    - **작업 이름**: mslearn-bike-automl
    - **새 실험 이름**: mslearn-bike-rental
    - **설명**: 자전거 대여 예측을 위한 자동화된 기계 학습
    - **태그**: *없음*

   **작업 유형 & 데이터**:

    - **작업 유형 선택**: 회귀
    - **데이터 세트 선택**: 다음 설정을 사용하여 새 데이터 세트를 만듭니다.
        - **데이터 형식**:
            - **이름**: bike-rentals
            - **설명**: 기록 자전거 대여 데이터
            - **형식**: 테이블 형식
        - **데이터 원본**:
            - **웹 파일에서** 선택
        - **웹 URL**: 
            - **웹 URL**: `https://aka.ms/bike-rentals`
            - **데이터 유효성 검사 건너뛰기**: ‘선택하지 않습니다’.
        - **설정**:
            - **파일 형식**: 구분 기호로 분리됨
            - **구분 기호**: 쉼표
            - **인코딩**: UTF-8
            - **열 헤더**: 첫 번째 파일에만 헤더가 있음
            - **행 건너뛰기**: 없음
            - **데이터 세트에 여러 줄 데이터가 포함되어 있음**: 선택하지 마세요.
        - **스키마**:
            - **경로** 이외의 모든 열 포함
            - 자동으로 검색된 형식 검토

        **자전거 대여** 데이터 세트를 만든 후 선택합니다.

    **작업 설정**:

    - **작업 유형**: 회귀
    - **데이터 세트**: bike-rentals
    - **대상 열**: 대여(정수)
    - **추가 구성 설정**:
        - **기본 메트릭**: 정규화된 루트 평균 제곱 오차
        - **최상의 모델 설명**: *선택되지 않음*
        - **지원되는 모든 모델 사용**: <u>선택 취소</u>합니다. 몇 가지 특정 알고리즘만 시도하도록 작업을 제한합니다.
        - **허용되는 모델**: **RandomForest** 및 **LightGBM**만 선택합니다. 일반적으로 가능한 한 많이 시도하려고 하지만 추가한 모델만큼 실험을 실행하는 데 걸리는 시간이 늘어납니다.
    - **제한**: *이 섹션 확장*
        - **최대 평가판**: 3
        - **최대 동시 평가판**: 3
        - **최대 노드**: 3
        - **메트릭 점수 임계값**: 0.85(*모델이 정규화된 제곱 평균 오차 메트릭 점수 0.085 이하를 달성하면 작업이 종료됩니다.*)
        - **시간 제한**: 15
        - **반복 시간 제한**: 5
        - **조기 종료 사용**: *선택됨*
    - **유효성 검사 및 테스트**:
        - **유효성 검사 유형**: 학습- 유효성 검사 분할
        - **유효성 검사 데이터의 백분율**: 10
        - **테스트 데이터 세트**: 없음

    **컴퓨팅**:

    - **컴퓨팅 유형 선택**: 서버리스
    - **가상 머신 유형**: CPU
    - **가상 머신 계층**: 전용
    - **가상 머신 크기**: Standard_DS3_V2
    - **인스턴스 수**: 1

1. 학습 작업을 제출합니다. 자동으로 시작됩니다.

1. 작업이 완료될 때까지 기다립니다. 시간이 걸릴 수도 있으므로 지금은 잠깐 쉬는 것이 좋을 수 있습니다.

## 최적 모델 검토

자동화된 기계 학습 작업이 완료되면 학습된 최상의 모델을 검토할 수 있습니다.

1. 자동화된 기계 학습 작업의 **개요** 탭에서 최적 모델 요약을 확인합니다.
    ![알고리즘 이름 주위에 상자가 있는 자동화된 기계 학습 작업의 최상의 모델 요약의 스크린샷](media/use-automated-machine-learning/complete-run.png)

    > **참고** "경고: 사용자가 지정한 종료 점수에 도달했습니다..."상태 메시지가 표시될 수 있습니다. 정상적인 메시지입니다. 다음 단계를 계속 진행하세요.
  
1. 최적 모델의 **알고리즘 이름** 아래의 텍스트를 선택하여 세부 정보를 확인합니다.

1. **메트릭** 탭을 선택하고 **잔차** 및 **predicted_true** 차트를 아직 선택하지 않은 경우 선택합니다. 

    모델의 성능을 보여 주는 차트를 검토합니다. **잔차** 차트는 *잔차*(예측 값과 실제 값의 차이)를 히스토그램으로 표시합니다. **predicted_true** 차트는 예측 값을 실제 값과 비교합니다. 

## 모델 배포 및 테스트

1. 자동화된 기계 학습 작업으로 학습된 최상의 모델에 대한 **모델** 탭에서 **배포** 를 선택하고 **웹 서비스** 옵션을 사용하여 다음 설정을 사용하여 모델을 배포합니다.
    - **이름**: predict-rentals
    - **설명**: 자전거 대여 예측
    - **컴퓨팅 형식**: Azure Container Instances
    - **인증 사용**: *선택됨*

1. 배포가 시작될 때까지 대기합니다. 이 작업에는 몇 초 정도 걸릴 수 있습니다. **predict-rentals** 엔드포인트에 대한 **배포 상태** 페이지의 기본 부분에 *실행* 중으로 표시됩니다.
1. **배포 상태** *성공*으로 변경될 때까지 기다립니다. 5~10분 정도 걸릴 수 있습니다.

## 배포된 서비스 테스트

이제 배포된 서비스를 테스트할 수 있습니다.

1. Azure Machine Learning 스튜디오 왼쪽 메뉴에서 **엔드포인트를** 선택하고 **predict-rentals** 실시간 엔드포인트를 엽니다.

1. **predict-rentals** 실시간 엔드포인트 페이지에서 **테스트** 탭을 봅니다.

1. **엔드포인트를 테스트할 입력 데이터** 창에서 템플릿 JSON을 다음 입력 데이터로 바꿉 있습니다.

    ```JSON
    {
      "Inputs": { 
        "data": [
          {
            "day": 1,
            "mnth": 1,   
            "year": 2022,
            "season": 2,
            "holiday": 0,
            "weekday": 1,
            "workingday": 1,
            "weathersit": 2, 
            "temp": 0.3, 
            "atemp": 0.3,
            "hum": 0.3,
            "windspeed": 0.3 
          }
        ]    
      },   
      "GlobalParameters": 1.0
    }
    ```

1. **테스트** 단추를 클릭합니다.

1. 다음과 유사한 입력 기능을 기반으로 예측된 대여 수를 포함하는 테스트 결과를 검토합니다.

    ```JSON
    {
      "Results": [
        444.27799000000000
      ]
    }
    ```

    테스트 창에서는 입력 데이터를 사용하고 예측된 대여 수를 반환하도록 학습한 모델을 사용했습니다.

수행한 작업을 검토해 보겠습니다. 이전 자전거 대여 데이터의 데이터 세트를 사용하여 모델을 학습시켰습니다. 이 모델은 계절 및 기상 *특성*을 기준으로 지정된 날에 예상되는 자전거 대여 수를 예측합니다.

## 정리

만든 웹 서비스는 *Azure Container Instance*에 호스트됩니다. 추가 실험 의사가 없는 경우 불필요한 Azure 사용이 발생하지 않도록 엔드포인트를 삭제해야 합니다.

1. [Azure Machine Learning Studio](https://ml.azure.com?azure-portal=true)의 **엔드포인트** 탭에서 **predict-rentals** 엔드포인트를 선택합니다. 그런 다음, **삭제**를 선택하고 엔드포인트를 삭제하겠다고 확인합니다.

    컴퓨팅을 삭제하면 컴퓨팅 리소스에 대한 구독 요금이 청구되지 않습니다. 그러나 구독에 Azure Machine Learning 작업 영역이 존재하는 동안에는 약간의 데이터 스토리지 요금이 청구됩니다. Azure Machine Learning 탐색을 완료했으면 Azure Machine Learning 작업 영역 및 관련 리소스를 삭제할 수 있습니다.

작업 영역을 삭제하려면,

1. [Azure Portal](https://portal.azure.com?azure-portal=true)의 **리소스 그룹** 페이지에서 Azure Machine Learning 작업 영역을 만들 때 지정한 리소스 그룹을 엽니다.
2. **리소스 그룹 삭제**를 클릭하고 삭제하고자 하는 리소스 그룹 이름을 입력한 다음 **삭제**를 선택합니다.
